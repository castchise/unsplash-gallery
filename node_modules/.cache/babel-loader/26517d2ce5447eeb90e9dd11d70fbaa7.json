{"ast":null,"code":"import _objectSpread from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"D:/react-playground/unsplash-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{createApi}from\"unsplash-js\";// import LazyImage from \"../LazyImage/lazy-image.component\";\nimport ImageItem from\"../ImageItem/image-item.component\";import Masonry from\"react-masonry-css\";import{removeDuplicateObjs}from\"../../utils/index\";import{createElement as _createElement}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var breakpointColumnsObj={500:1,768:2,default:3};var ImageContainer=/*#__PURE__*/function(_React$Component){_inherits(ImageContainer,_React$Component);var _super=_createSuper(ImageContainer);function ImageContainer(){var _this;_classCallCheck(this,ImageContainer);_this=_super.call(this);_this.updateListOnScroll=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var pagePercentageScrolled;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:pagePercentageScrolled=Math.floor(window.scrollY/(_this.getDocHeight()-window.innerHeight)*100);if(!(pagePercentageScrolled>70&&!_this.state.loading)){_context.next=6;break;}_this.setState(function(prevState){return{page:prevState.page+1,loading:!prevState.loading};});_context.next=5;return _this.getUnsplashPhotos(20);case 5:_this.setState(function(prevState){return{loading:!prevState.loading};});case 6:case\"end\":return _context.stop();}}},_callee);}));_this.getDocHeight=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);};_this.getUnsplashPhotos=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(itemsCount){var unsplash,_yield$unsplash$photo,response,updatedList;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:unsplash=createApi({accessKey:process.env.REACT_APP_UNSPLASH_ACCESS_KEY});_context2.next=3;return unsplash.photos.list({page:_this.state.page,perPage:itemsCount||20});case 3:_yield$unsplash$photo=_context2.sent;response=_yield$unsplash$photo.response;updatedList=_this.state.photosList.concat(_this.removeAdPictures(response.results));_this.setState({photosList:updatedList});case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.getLocalPhotos=function(){var LS=window.localStorage;var storedItems=_toConsumableArray(JSON.parse(LS[\"unsplash-app-storage\"]||\"[]\"));storedItems=removeDuplicateObjs(storedItems);_this.setState({photosList:storedItems});};_this.removeAdPictures=function(list){return list.filter(function(item){if(!item.sponsorship){item.loaded=false;return item;}return false;});};_this.state={photosList:[],page:1,loading:false};return _this;}_createClass(ImageContainer,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(this.props.sourceType===\"unsplash\")){_context3.next=5;break;}_context3.next=3;return this.getUnsplashPhotos();case 3:_context3.next=6;break;case 5:if(this.props.sourceType===\"local\"){this.getLocalPhotos();}case 6:window.addEventListener(\"scroll\",this.updateListOnScroll);case 7:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentDidUpdate\",value:function(){var _componentDidUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(prevProps){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(this.props.sourceType===\"unsplash\"&&prevProps.sourceType===\"local\")){_context4.next=6;break;}this.setState({photosList:[]});_context4.next=4;return this.getUnsplashPhotos();case 4:_context4.next=7;break;case 6:if(this.props.sourceType===\"local\"&&prevProps.sourceType===\"unsplash\"){this.setState({photosList:[]});this.getLocalPhotos();}case 7:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidUpdate(_x2){return _componentDidUpdate.apply(this,arguments);}return componentDidUpdate;}()},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"p-5 sm:p-7 md:p-10\",children:[/*#__PURE__*/_jsx(Masonry,{breakpointCols:breakpointColumnsObj,className:\"my-masonry-grid flex -ml-5\",columnClassName:\"my-masonry-grid_column bg-clip-padding pl-5\",children:this.state.photosList.map(function(photo){return/*#__PURE__*/_createElement(ImageItem,_objectSpread(_objectSpread({},photo),{},{key:photo.id}));})}),this.props.sourceType===\"local\"&&this.state.photosList.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"mt-24 w-full flex-col text-center \",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-5 font-semibold text-4xl\",children:\"No stored photos found! \\uD83D\\uDE22\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl\",children:\"Change source type and try to add them to your local gallery!\"})]}):null]});}}]);return ImageContainer;}(React.Component);export{ImageContainer as default};","map":{"version":3,"sources":["D:/react-playground/unsplash-test/src/components/ImageContainer/image-container.component.jsx"],"names":["React","createApi","ImageItem","Masonry","removeDuplicateObjs","breakpointColumnsObj","default","ImageContainer","updateListOnScroll","pagePercentageScrolled","Math","floor","window","scrollY","getDocHeight","innerHeight","state","loading","setState","prevState","page","getUnsplashPhotos","max","document","body","scrollHeight","documentElement","offsetHeight","clientHeight","itemsCount","unsplash","accessKey","process","env","REACT_APP_UNSPLASH_ACCESS_KEY","photos","list","perPage","response","updatedList","photosList","concat","removeAdPictures","results","getLocalPhotos","LS","localStorage","storedItems","JSON","parse","filter","item","sponsorship","loaded","props","sourceType","addEventListener","prevProps","map","photo","id","length","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\n\nimport { createApi } from \"unsplash-js\";\n\n// import LazyImage from \"../LazyImage/lazy-image.component\";\nimport ImageItem from \"../ImageItem/image-item.component\";\nimport Masonry from \"react-masonry-css\";\nimport { removeDuplicateObjs } from \"../../utils/index\";\n\nconst breakpointColumnsObj = {\n  500: 1,\n  768: 2,\n  default: 3\n};\n\nexport default class ImageContainer extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      photosList: [],\n      page: 1,\n      loading: false\n    };\n  }\n\n  async componentDidMount() {\n    if (this.props.sourceType === \"unsplash\") {\n      await this.getUnsplashPhotos();\n    } else if (this.props.sourceType === \"local\") {\n      this.getLocalPhotos();\n    }\n    window.addEventListener(\"scroll\", this.updateListOnScroll);\n  }\n\n  updateListOnScroll = async () => {\n    const pagePercentageScrolled = Math.floor(\n      (window.scrollY / (this.getDocHeight() - window.innerHeight)) * 100\n    );\n\n    if (pagePercentageScrolled > 70 && !this.state.loading) {\n      this.setState((prevState) => ({\n        page: prevState.page + 1,\n        loading: !prevState.loading\n      }));\n      await this.getUnsplashPhotos(20);\n      this.setState((prevState) => ({ loading: !prevState.loading }));\n    }\n  };\n\n  async componentDidUpdate(prevProps) {\n    if (\n      this.props.sourceType === \"unsplash\" &&\n      prevProps.sourceType === \"local\"\n    ) {\n      this.setState({ photosList: [] });\n      await this.getUnsplashPhotos();\n    } else if (\n      this.props.sourceType === \"local\" &&\n      prevProps.sourceType === \"unsplash\"\n    ) {\n      this.setState({ photosList: [] });\n      this.getLocalPhotos();\n    }\n  }\n\n  getDocHeight = () => {\n    return Math.max(\n      document.body.scrollHeight,\n      document.documentElement.scrollHeight,\n      document.body.offsetHeight,\n      document.documentElement.offsetHeight,\n      document.body.clientHeight,\n      document.documentElement.clientHeight\n    );\n  };\n\n  getUnsplashPhotos = async (itemsCount) => {\n    const unsplash = createApi({\n      accessKey: process.env.REACT_APP_UNSPLASH_ACCESS_KEY\n    });\n    const { response } = await unsplash.photos.list({\n      page: this.state.page,\n      perPage: itemsCount || 20\n    });\n    const updatedList = this.state.photosList.concat(\n      this.removeAdPictures(response.results)\n    );\n    this.setState({ photosList: updatedList });\n  };\n\n  getLocalPhotos = () => {\n    const LS = window.localStorage;\n    let storedItems = [...JSON.parse(LS[\"unsplash-app-storage\"] || \"[]\")];\n    storedItems = removeDuplicateObjs(storedItems);\n    this.setState({ photosList: storedItems });\n  };\n\n  removeAdPictures = (list) =>\n    list.filter((item) => {\n      if (!item.sponsorship) {\n        item.loaded = false;\n        return item;\n      }\n      return false;\n    });\n\n  render() {\n    return (\n      <div className=\"p-5 sm:p-7 md:p-10\">\n        <Masonry\n          breakpointCols={breakpointColumnsObj}\n          className=\"my-masonry-grid flex -ml-5\"\n          columnClassName=\"my-masonry-grid_column bg-clip-padding pl-5\"\n        >\n          {this.state.photosList.map((photo) => (\n            <ImageItem {...photo} key={photo.id} />\n          ))}\n        </Masonry>\n        {this.props.sourceType === \"local\" &&\n        this.state.photosList.length === 0 ? (\n          <div className=\"mt-24 w-full flex-col text-center \">\n            <p className=\"mb-5 font-semibold text-4xl\">\n              No stored photos found! 😢\n            </p>\n            <p className=\"text-xl\">\n              Change source type and try to add them to your local gallery!\n            </p>\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}